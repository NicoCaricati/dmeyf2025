2025-10-22 02:01:36,229 - INFO - __main__ 33 - Iniciando programa de optimizaci√≥n con log fechado
2025-10-22 02:01:36,229 - INFO - __main__ 36 - Configuraci√≥n cargada desde YAML
2025-10-22 02:01:36,229 - INFO - __main__ 37 - STUDY_NAME: TEST 1 - Modelo Final  - Reoptimizando con Historicas 1
2025-10-22 02:01:36,229 - INFO - __main__ 38 - DATA_PATH: ../../../data/competencia_03.csv
2025-10-22 02:01:36,229 - INFO - __main__ 39 - SEMILLA: [5555571]
2025-10-22 02:01:36,229 - INFO - __main__ 40 - MES_TRAIN: [2021, 202102]
2025-10-22 02:01:36,229 - INFO - __main__ 41 - MESES_OPTIMIZACION: [2021, 202102, 202103, 202104]
2025-10-22 02:01:36,229 - INFO - __main__ 42 - MES_VALIDACION: 202103
2025-10-22 02:01:36,229 - INFO - __main__ 43 - MES_TEST: 202104
2025-10-22 02:01:36,229 - INFO - __main__ 44 - FINAL_TRAIN: [202101, 202102, 202103, 202104]
2025-10-22 02:01:36,229 - INFO - __main__ 45 - FINAL_PREDIC: 202106
2025-10-22 02:01:36,229 - INFO - __main__ 46 - GANANCIA_ACIERTO: 780000
2025-10-22 02:01:36,229 - INFO - __main__ 47 - COSTO_ESTIMULO: 20000
2025-10-22 02:01:36,229 - INFO - __main__ 48 - UMBRAL: 0.015
2025-10-22 02:01:36,229 - INFO - __main__ 49 - HIPERPARAMETROS: {'num_leaves': {'min': 20, 'max': 200, 'type': 'int'}, 'learning_rate': {'min': 0.005, 'max': 0.06, 'type': 'float'}, 'min_data_in_leaf': {'min': 300, 'max': 1000, 'type': 'int'}, 'feature_fraction': {'min': 0.15, 'max': 0.6, 'type': 'float'}, 'bagging_fraction': {'min': 0.15, 'max': 0.7, 'type': 'float'}, 'num_boost_round': {'min': 300, 'max': 1200, 'type': 'int'}}
2025-10-22 02:01:36,229 - INFO - __main__ 55 - === INICIANDO OPTIMIZACI√ìN CON CONFIGURACI√ìN YAML ===
2025-10-22 02:01:37,702 - INFO - __main__ 58 - ‚úÖ df_fe.csv encontrado
2025-10-22 02:06:20,544 - INFO - __main__ 165 - ‚è≥ CSV cargado o creado, ahora ejecutando optimizaci√≥n...
2025-10-22 02:06:20,545 - INFO - optimization 192 - Iniciando optimizaci√≥n con 5 trials
2025-10-22 02:06:20,545 - INFO - optimization 193 - Configuraci√≥n: TRAIN=[2021, 202102], VALID=202103, SEMILLA=[5555571]
2025-10-22 02:06:21,498 - INFO - optimization 254 - üìÅ Usando storage: sqlite:///../../../buckets/b1/Compe_02/optuna_db/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1.db
2025-10-22 02:06:46,475 - INFO - optimization 267 - üèÜ Mejor ganancia hasta ahora: 2,147,451,734
2025-10-22 02:06:55,555 - INFO - optimization 212 - üîÑ Retomando desde trial 5
2025-10-22 02:06:55,556 - INFO - optimization 213 - üìù Trials a ejecutar: 0 (total objetivo: 5)
2025-10-22 02:06:55,556 - INFO - optimization 224 - ‚úÖ Ya se completaron 5 trials
2025-10-22 02:06:55,556 - INFO - __main__ 184 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-22 02:06:55,556 - INFO - best_params 20 - Cargando el json con los mejores hiperparametros
2025-10-22 02:06:55,556 - INFO - best_params 36 - Mejores hiperpar√°metros cargados desde resultados/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_iteraciones.json
2025-10-22 02:06:55,556 - INFO - best_params 37 - Mejor ganancia encontrada: 2,147,451,734
2025-10-22 02:06:55,556 - INFO - best_params 38 - Trial n√∫mero: 3
2025-10-22 02:06:55,556 - INFO - best_params 39 - Par√°metros: {'num_leaves': 23, 'learning_rate': 0.015429635744314982, 'min_data_in_leaf': 471, 'feature_fraction': 0.2908610795670702, 'bagging_fraction': 0.6839570348974631, 'num_boost_round': 958}
2025-10-22 02:06:55,556 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-22 02:06:55,556 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-22 02:10:56,264 - INFO - config 520 - === Comparando 1 semillas ===
2025-10-22 02:10:56,265 - INFO - config 527 - üîÅ Semilla: 5555571
2025-10-22 02:10:56,265 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-22 02:10:56,266 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-22 02:14:58,905 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-22 02:14:58,911 - INFO - grafico_test 40 - Ganancia m√°xima: 224,100,000 en posici√≥n 6074
2025-10-22 02:14:58,911 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.037976
2025-10-22 02:15:00,302 - INFO - config 609 - ‚úÖ Gr√°fico comparativo guardado: resultados/plots/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_comparativo_semillas_20251022_021459.png
2025-10-22 02:15:08,151 - INFO - config 104 - Resultados de test guardados en resultados/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_test_results.json
2025-10-22 02:15:08,151 - INFO - __main__ 216 - === RESUMEN DE EVALUACI√ìN EN TEST ===
2025-10-22 02:15:08,151 - INFO - __main__ 217 - ‚úÖ Ganancia en test: 2,147,480,000
2025-10-22 02:15:08,151 - INFO - __main__ 218 - üéØ Predicciones positivas: 11,706 (11.68%)
2025-10-22 02:15:08,151 - INFO - __main__ 221 - === GRAFICO DE TEST ===
2025-10-22 02:15:08,741 - INFO - __main__ 230 - === GRAFICO DE TEST ===
2025-10-22 02:15:08,741 - INFO - grafico_test 58 - Generando gr√°fico de ganancia avanzado...
2025-10-22 02:15:08,741 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-22 02:15:08,745 - INFO - grafico_test 40 - Ganancia m√°xima: 224,100,000 en posici√≥n 6074
2025-10-22 02:15:08,745 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.037976
2025-10-22 02:15:10,374 - INFO - grafico_test 149 - Gr√°fico avanzado guardado: resultados/plots/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_ganancia_avanzado_20251022_021509.png
2025-10-22 02:15:10,374 - INFO - grafico_test 150 - Datos guardados: resultados/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_datos_ganancia_20251022_021509.csv
2025-10-22 02:15:10,375 - INFO - __main__ 235 - === ENTRENAMIENTO FINAL ===
2025-10-22 02:15:10,375 - INFO - __main__ 236 - Preparar datos para entrenamiento final
2025-10-22 02:15:10,375 - INFO - final_training 23 - Preparando datos para entrenamiento final
2025-10-22 02:15:10,375 - INFO - final_training 24 - Per√≠odos de entrenamiento: [202101, 202102, 202103, 202104]
2025-10-22 02:15:10,375 - INFO - final_training 25 - Per√≠odo de predicci√≥n: 202106
2025-10-22 02:15:15,407 - INFO - final_training 50 - Features utilizadas: 2340
2025-10-22 02:15:15,409 - INFO - final_training 51 - Distribuci√≥n del target - 0: 394,341, 1: 4,496
2025-10-22 02:15:15,409 - INFO - __main__ 240 - Entrenar modelo final
2025-10-22 02:15:15,409 - INFO - final_training 67 - Iniciando entrenamiento del modelo final
2025-10-22 02:15:15,409 - INFO - final_training 79 - Par√°metros del modelo: {'objective': 'binary', 'metric': 'None', 'random_state': 5555571, 'verbose': -1, 'extra_trees': False, 'num_leaves': 23, 'learning_rate': 0.015429635744314982, 'min_data_in_leaf': 471, 'feature_fraction': 0.2908610795670702, 'bagging_fraction': 0.6839570348974631, 'num_boost_round': 958}
2025-10-22 02:20:16,852 - INFO - __main__ 244 - Generar predicciones finales
2025-10-22 02:20:16,853 - INFO - final_training 159 - Generando predicciones finales
2025-10-22 02:20:20,367 - INFO - final_training 232 - Importancia de las primeras 1000 variables guardada en 'feature_importance/feature_importance_TEST 1 - Modelo Final  - Reoptimizando con Historicas 1.csv'
2025-10-22 02:20:20,368 - INFO - final_training 180 - Predicciones con umbral generadas:
2025-10-22 02:20:20,368 - INFO - final_training 181 -   Total clientes: 100,693
2025-10-22 02:20:20,368 - INFO - final_training 182 -   Positivas: 10,987 (10.91%)
2025-10-22 02:20:20,368 - INFO - final_training 183 -   Umbral utilizado: 0.015
2025-10-22 02:20:20,369 - INFO - final_training 189 - Generando predicciones con top_k=11,750
2025-10-22 02:20:20,377 - INFO - final_training 201 -   Predicciones top_k generadas (K=11,750)
2025-10-22 02:20:20,378 - INFO - final_training 202 -   M√°xima probabilidad: 0.9482
2025-10-22 02:20:20,378 - INFO - final_training 203 -   M√≠nima probabilidad dentro del top_k: 0.0138
2025-10-22 02:20:20,378 - INFO - __main__ 248 - Guardar predicciones
2025-10-22 02:20:20,431 - INFO - output_manager 32 - Predicciones (umbral) guardadas en: predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_umbral_20251022_022020.csv
2025-10-22 02:20:20,431 - INFO - output_manager 33 -   Columnas: ['numero_de_cliente', 'predict']
2025-10-22 02:20:20,431 - INFO - output_manager 34 -   Registros: 100,693
2025-10-22 02:20:20,455 - INFO - output_manager 35 -   Primeras filas:
   numero_de_cliente  predict
0          249350768        0
1          249432306        0
2          249565688        0
3          249596175        0
4          249695645        1
2025-10-22 02:20:20,509 - INFO - output_manager 32 - Predicciones (top_k) guardadas en: predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_top_k_20251022_022020.csv
2025-10-22 02:20:20,509 - INFO - output_manager 33 -   Columnas: ['numero_de_cliente', 'predict']
2025-10-22 02:20:20,509 - INFO - output_manager 34 -   Registros: 100,693
2025-10-22 02:20:20,512 - INFO - output_manager 35 -   Primeras filas:
       numero_de_cliente  predict
87333          957781338        1
21685          519562169        1
86657         1237423372        1
96955          960841355        1
89055          750344678        1
2025-10-22 02:20:20,512 - INFO - __main__ 252 - === RESUMEN FINAL ===
2025-10-22 02:20:20,512 - INFO - __main__ 253 - Entrenamiento final completado exitosamente
2025-10-22 02:20:20,512 - INFO - __main__ 254 - Mejores hiperpar√°metros utilizados: {'num_leaves': 23, 'learning_rate': 0.015429635744314982, 'min_data_in_leaf': 471, 'feature_fraction': 0.2908610795670702, 'bagging_fraction': 0.6839570348974631, 'num_boost_round': 958}
2025-10-22 02:20:20,512 - INFO - __main__ 255 - Per√≠odos de entrenamiento: [202101, 202102, 202103, 202104]
2025-10-22 02:20:20,512 - INFO - __main__ 256 - Per√≠odo de predicci√≥n: 202106
2025-10-22 02:20:20,512 - INFO - __main__ 257 - Archivo de salida: {'umbral': 'predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_umbral_20251022_022020.csv', 'top_k': 'predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_top_k_20251022_022020.csv'}
2025-10-22 02:20:20,512 - INFO - __main__ 258 - Log detallado: logs/log_TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_2025-10-22_02-01-36.log
2025-10-22 02:20:20,512 - INFO - __main__ 261 - >>> Ejecuci√≥n finalizada. Revisar logs para mas detalles.
