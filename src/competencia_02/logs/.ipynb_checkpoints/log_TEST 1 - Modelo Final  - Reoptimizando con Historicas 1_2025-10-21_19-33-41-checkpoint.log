2025-10-21 19:33:41,113 - INFO - __main__ 33 - Iniciando programa de optimizaci√≥n con log fechado
2025-10-21 19:33:41,113 - INFO - __main__ 36 - Configuraci√≥n cargada desde YAML
2025-10-21 19:33:41,114 - INFO - __main__ 37 - STUDY_NAME: TEST 1 - Modelo Final  - Reoptimizando con Historicas 1
2025-10-21 19:33:41,114 - INFO - __main__ 38 - DATA_PATH: ../../../data/competencia_03.csv
2025-10-21 19:33:41,114 - INFO - __main__ 39 - SEMILLA: [555557, 555871, 556219, 556459, 556691, 556903, 557159, 557399, 557597, 557861]
2025-10-21 19:33:41,114 - INFO - __main__ 40 - MES_TRAIN: [2021, 202102]
2025-10-21 19:33:41,114 - INFO - __main__ 41 - MESES_OPTIMIZACION: [2021, 202102, 202103, 202104]
2025-10-21 19:33:41,114 - INFO - __main__ 42 - MES_VALIDACION: 202103
2025-10-21 19:33:41,114 - INFO - __main__ 43 - MES_TEST: 202104
2025-10-21 19:33:41,114 - INFO - __main__ 44 - FINAL_TRAIN: [202101, 202102, 202103, 202104]
2025-10-21 19:33:41,114 - INFO - __main__ 45 - FINAL_PREDIC: 202106
2025-10-21 19:33:41,114 - INFO - __main__ 46 - GANANCIA_ACIERTO: 780000
2025-10-21 19:33:41,114 - INFO - __main__ 47 - COSTO_ESTIMULO: 20000
2025-10-21 19:33:41,114 - INFO - __main__ 48 - UMBRAL: 0.015
2025-10-21 19:33:41,114 - INFO - __main__ 49 - HIPERPARAMETROS: {'num_leaves': {'min': 20, 'max': 200, 'type': 'int'}, 'learning_rate': {'min': 0.005, 'max': 0.06, 'type': 'float'}, 'min_data_in_leaf': {'min': 300, 'max': 1000, 'type': 'int'}, 'feature_fraction': {'min': 0.15, 'max': 0.6, 'type': 'float'}, 'bagging_fraction': {'min': 0.15, 'max': 0.7, 'type': 'float'}, 'num_boost_round': {'min': 300, 'max': 1200, 'type': 'int'}}
2025-10-21 19:33:41,114 - INFO - __main__ 55 - === INICIANDO OPTIMIZACI√ìN CON CONFIGURACI√ìN YAML ===
2025-10-21 19:33:41,712 - INFO - __main__ 58 - ‚úÖ df_fe.csv encontrado
2025-10-21 19:40:45,623 - INFO - __main__ 165 - ‚è≥ CSV cargado o creado, ahora ejecutando optimizaci√≥n...
2025-10-21 19:40:45,624 - INFO - optimization 192 - Iniciando optimizaci√≥n con 5 trials
2025-10-21 19:40:45,624 - INFO - optimization 193 - Configuraci√≥n: TRAIN=[2021, 202102], VALID=202103, SEMILLA=[555557, 555871, 556219, 556459, 556691, 556903, 557159, 557399, 557597, 557861]
2025-10-21 19:40:46,026 - INFO - optimization 254 - üìÅ Usando storage: sqlite:///../../../buckets/b1/Compe_02/optuna_db/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1.db
2025-10-21 19:41:07,074 - INFO - optimization 267 - üèÜ Mejor ganancia hasta ahora: 2,147,451,734
2025-10-21 19:41:12,670 - INFO - optimization 212 - üîÑ Retomando desde trial 5
2025-10-21 19:41:12,670 - INFO - optimization 213 - üìù Trials a ejecutar: 0 (total objetivo: 5)
2025-10-21 19:41:12,670 - INFO - optimization 224 - ‚úÖ Ya se completaron 5 trials
2025-10-21 19:41:12,670 - INFO - __main__ 170 - === AN√ÅLISIS DE RESULTADOS ===
2025-10-21 19:41:15,071 - INFO - __main__ 176 - Trial 1: Ganancia=2147451734 | Par√°metros={'bagging_fraction': 0.6839570348974631, 'feature_fraction': 0.2908610795670702, 'learning_rate': 0.015429635744314982, 'min_data_in_leaf': 471, 'num_boost_round': 958, 'num_leaves': 23}
2025-10-21 19:41:15,071 - INFO - __main__ 176 - Trial 2: Ganancia=2147427923 | Par√°metros={'bagging_fraction': 0.22846843449206128, 'feature_fraction': 0.4032861618416379, 'learning_rate': 0.044922772942821855, 'min_data_in_leaf': 877, 'num_boost_round': 814, 'num_leaves': 53}
2025-10-21 19:41:15,071 - INFO - __main__ 176 - Trial 3: Ganancia=2147403760 | Par√°metros={'bagging_fraction': 0.539238063640356, 'feature_fraction': 0.5410246812787127, 'learning_rate': 0.007294745318610658, 'min_data_in_leaf': 626, 'num_boost_round': 1086, 'num_leaves': 35}
2025-10-21 19:41:15,072 - INFO - __main__ 176 - Trial 4: Ganancia=nan | Par√°metros={'bagging_fraction': 0.22846843449206128, 'feature_fraction': 0.4032861618416379, 'learning_rate': 0.044922772942821855, 'min_data_in_leaf': 877, 'num_boost_round': 814, 'num_leaves': 53}
2025-10-21 19:41:15,072 - INFO - __main__ 176 - Trial 5: Ganancia=nan | Par√°metros={'bagging_fraction': 0.22846843449206128, 'feature_fraction': 0.4032861618416379, 'learning_rate': 0.044922772942821855, 'min_data_in_leaf': 877, 'num_boost_round': 814, 'num_leaves': 53}
2025-10-21 19:41:15,072 - INFO - __main__ 178 - === OPTIMIZACI√ìN COMPLETADA ===
2025-10-21 19:41:15,072 - INFO - __main__ 181 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 19:41:15,072 - INFO - best_params 20 - Cargando el json con los mejores hiperparametros
2025-10-21 19:41:15,072 - INFO - best_params 36 - Mejores hiperpar√°metros cargados desde resultados/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_iteraciones.json
2025-10-21 19:41:15,072 - INFO - best_params 37 - Mejor ganancia encontrada: 2,147,451,734
2025-10-21 19:41:15,072 - INFO - best_params 38 - Trial n√∫mero: 3
2025-10-21 19:41:15,072 - INFO - best_params 39 - Par√°metros: {'num_leaves': 23, 'learning_rate': 0.015429635744314982, 'min_data_in_leaf': 471, 'feature_fraction': 0.2908610795670702, 'bagging_fraction': 0.6839570348974631, 'num_boost_round': 958}
2025-10-21 19:41:15,072 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 19:41:15,072 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 19:47:58,607 - INFO - config 520 - === Comparando 10 semillas ===
2025-10-21 19:47:58,608 - INFO - config 527 - üîÅ Semilla: 555557
2025-10-21 19:47:58,609 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 19:47:58,609 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 19:55:50,725 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 19:55:50,815 - INFO - grafico_test 40 - Ganancia m√°xima: 227,160,000 en posici√≥n 6521
2025-10-21 19:55:50,816 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.034711
2025-10-21 19:55:50,816 - INFO - config 527 - üîÅ Semilla: 555871
2025-10-21 19:55:50,816 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 19:55:50,817 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:02:34,923 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:02:34,930 - INFO - grafico_test 40 - Ganancia m√°xima: 227,960,000 en posici√≥n 6441
2025-10-21 20:02:34,930 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.034069
2025-10-21 20:02:34,930 - INFO - config 527 - üîÅ Semilla: 556219
2025-10-21 20:02:34,930 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:02:34,931 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:09:17,258 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:09:17,266 - INFO - grafico_test 40 - Ganancia m√°xima: 226,800,000 en posici√≥n 6099
2025-10-21 20:09:17,266 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.037161
2025-10-21 20:09:17,266 - INFO - config 527 - üîÅ Semilla: 556459
2025-10-21 20:09:17,266 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:09:17,267 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:15:57,824 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:15:57,831 - INFO - grafico_test 40 - Ganancia m√°xima: 228,240,000 en posici√≥n 7187
2025-10-21 20:15:57,831 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.029959
2025-10-21 20:15:57,831 - INFO - config 527 - üîÅ Semilla: 556691
2025-10-21 20:15:57,832 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:15:57,832 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:22:39,790 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:22:39,797 - INFO - grafico_test 40 - Ganancia m√°xima: 226,920,000 en posici√≥n 6013
2025-10-21 20:22:39,797 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.037227
2025-10-21 20:22:39,798 - INFO - config 527 - üîÅ Semilla: 556903
2025-10-21 20:22:39,798 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:22:39,798 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:29:21,450 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:29:21,457 - INFO - grafico_test 40 - Ganancia m√°xima: 225,320,000 en posici√≥n 6453
2025-10-21 20:29:21,457 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.034203
2025-10-21 20:29:21,457 - INFO - config 527 - üîÅ Semilla: 557159
2025-10-21 20:29:21,458 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:29:21,458 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:36:21,951 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:36:21,960 - INFO - grafico_test 40 - Ganancia m√°xima: 227,320,000 en posici√≥n 5473
2025-10-21 20:36:21,960 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.042325
2025-10-21 20:36:21,961 - INFO - config 527 - üîÅ Semilla: 557399
2025-10-21 20:36:21,961 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:36:21,961 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:43:15,041 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:43:15,050 - INFO - grafico_test 40 - Ganancia m√°xima: 224,460,000 en posici√≥n 5856
2025-10-21 20:43:15,050 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.038852
2025-10-21 20:43:15,051 - INFO - config 527 - üîÅ Semilla: 557597
2025-10-21 20:43:15,051 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:43:15,051 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:49:58,338 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:49:58,345 - INFO - grafico_test 40 - Ganancia m√°xima: 224,640,000 en posici√≥n 5247
2025-10-21 20:49:58,345 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.043999
2025-10-21 20:49:58,346 - INFO - config 527 - üîÅ Semilla: 557861
2025-10-21 20:49:58,346 - INFO - config 29 - === EVALUACI√ìN EN CONJUNTO DE TEST ===
2025-10-21 20:49:58,346 - INFO - config 30 - Per√≠odo de test: 202104
2025-10-21 20:56:48,280 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:56:48,291 - INFO - grafico_test 40 - Ganancia m√°xima: 226,080,000 en posici√≥n 7775
2025-10-21 20:56:48,292 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.025972
2025-10-21 20:56:50,685 - INFO - config 609 - ‚úÖ Gr√°fico comparativo guardado: resultados/plots/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_comparativo_semillas_20251021_205649.png
2025-10-21 20:56:58,819 - INFO - config 104 - Resultados de test guardados en resultados/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_test_results.json
2025-10-21 20:56:58,819 - INFO - __main__ 213 - === RESUMEN DE EVALUACI√ìN EN TEST ===
2025-10-21 20:56:58,819 - INFO - __main__ 214 - ‚úÖ Ganancia en test: 2,147,480,000
2025-10-21 20:56:58,819 - INFO - __main__ 215 - üéØ Predicciones positivas: 11,821 (11.80%)
2025-10-21 20:56:58,819 - INFO - __main__ 218 - === GRAFICO DE TEST ===
2025-10-21 20:56:59,565 - INFO - __main__ 227 - === GRAFICO DE TEST ===
2025-10-21 20:56:59,565 - INFO - grafico_test 58 - Generando gr√°fico de ganancia avanzado...
2025-10-21 20:56:59,565 - INFO - grafico_test 25 - Calculando ganancia acumulada optimizada...
2025-10-21 20:56:59,571 - INFO - grafico_test 40 - Ganancia m√°xima: 227,160,000 en posici√≥n 6521
2025-10-21 20:56:59,571 - INFO - grafico_test 41 - Umbral √≥ptimo: 0.034711
2025-10-21 20:57:02,064 - INFO - grafico_test 149 - Gr√°fico avanzado guardado: resultados/plots/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_ganancia_avanzado_20251021_205659.png
2025-10-21 20:57:02,064 - INFO - grafico_test 150 - Datos guardados: resultados/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_datos_ganancia_20251021_205659.csv
2025-10-21 20:57:02,064 - INFO - __main__ 232 - === ENTRENAMIENTO FINAL ===
2025-10-21 20:57:02,065 - INFO - __main__ 233 - Preparar datos para entrenamiento final
2025-10-21 20:57:02,065 - INFO - final_training 23 - Preparando datos para entrenamiento final
2025-10-21 20:57:02,065 - INFO - final_training 24 - Per√≠odos de entrenamiento: [202101, 202102, 202103, 202104]
2025-10-21 20:57:02,065 - INFO - final_training 25 - Per√≠odo de predicci√≥n: 202106
2025-10-21 20:57:17,624 - INFO - final_training 50 - Features utilizadas: 2340
2025-10-21 20:57:17,627 - INFO - final_training 51 - Distribuci√≥n del target - 0: 394,341, 1: 4,496
2025-10-21 20:57:17,627 - INFO - __main__ 237 - Entrenar modelo final
2025-10-21 20:57:17,627 - INFO - final_training 67 - Iniciando entrenamiento del modelo final
2025-10-21 20:57:17,627 - INFO - final_training 79 - Par√°metros del modelo: {'objective': 'binary', 'metric': 'None', 'random_state': 555557, 'verbose': -1, 'extra_trees': False, 'num_leaves': 23, 'learning_rate': 0.015429635744314982, 'min_data_in_leaf': 471, 'feature_fraction': 0.2908610795670702, 'bagging_fraction': 0.6839570348974631, 'num_boost_round': 958}
2025-10-21 21:04:46,957 - INFO - __main__ 241 - Generar predicciones finales
2025-10-21 21:04:46,958 - INFO - final_training 159 - Generando predicciones finales
2025-10-21 21:04:55,489 - INFO - final_training 232 - Importancia de las primeras 1000 variables guardada en 'feature_importance/feature_importance_TEST 1 - Modelo Final  - Reoptimizando con Historicas 1.csv'
2025-10-21 21:04:55,489 - INFO - final_training 180 - Predicciones con umbral generadas:
2025-10-21 21:04:55,489 - INFO - final_training 181 -   Total clientes: 100,693
2025-10-21 21:04:55,489 - INFO - final_training 182 -   Positivas: 10,955 (10.88%)
2025-10-21 21:04:55,489 - INFO - final_training 183 -   Umbral utilizado: 0.015
2025-10-21 21:04:55,492 - INFO - final_training 189 - Generando predicciones con top_k=11,750
2025-10-21 21:04:55,520 - INFO - final_training 201 -   Predicciones top_k generadas (K=11,750)
2025-10-21 21:04:55,521 - INFO - final_training 202 -   M√°xima probabilidad: 0.9382
2025-10-21 21:04:55,521 - INFO - final_training 203 -   M√≠nima probabilidad dentro del top_k: 0.0137
2025-10-21 21:04:55,521 - INFO - __main__ 245 - Guardar predicciones
2025-10-21 21:04:55,646 - INFO - output_manager 32 - Predicciones (umbral) guardadas en: predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_umbral_20251021_210455.csv
2025-10-21 21:04:55,647 - INFO - output_manager 33 -   Columnas: ['numero_de_cliente', 'predict']
2025-10-21 21:04:55,647 - INFO - output_manager 34 -   Registros: 100,693
2025-10-21 21:04:55,688 - INFO - output_manager 35 -   Primeras filas:
   numero_de_cliente  predict
0          249350768        0
1          249432306        0
2          249565688        0
3          249596175        0
4          249695645        0
2025-10-21 21:04:55,783 - INFO - output_manager 32 - Predicciones (top_k) guardadas en: predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_top_k_20251021_210455.csv
2025-10-21 21:04:55,783 - INFO - output_manager 33 -   Columnas: ['numero_de_cliente', 'predict']
2025-10-21 21:04:55,783 - INFO - output_manager 34 -   Registros: 100,693
2025-10-21 21:04:55,787 - INFO - output_manager 35 -   Primeras filas:
       numero_de_cliente  predict
86657         1237423372        1
29848          710633266        1
87333          957781338        1
21685          519562169        1
96955          960841355        1
2025-10-21 21:04:55,787 - INFO - __main__ 249 - === RESUMEN FINAL ===
2025-10-21 21:04:55,787 - INFO - __main__ 250 - Entrenamiento final completado exitosamente
2025-10-21 21:04:55,787 - INFO - __main__ 251 - Mejores hiperpar√°metros utilizados: {'num_leaves': 23, 'learning_rate': 0.015429635744314982, 'min_data_in_leaf': 471, 'feature_fraction': 0.2908610795670702, 'bagging_fraction': 0.6839570348974631, 'num_boost_round': 958}
2025-10-21 21:04:55,788 - INFO - __main__ 252 - Per√≠odos de entrenamiento: [202101, 202102, 202103, 202104]
2025-10-21 21:04:55,788 - INFO - __main__ 253 - Per√≠odo de predicci√≥n: 202106
2025-10-21 21:04:55,788 - INFO - __main__ 254 - Archivo de salida: {'umbral': 'predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_umbral_20251021_210455.csv', 'top_k': 'predict/TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_top_k_20251021_210455.csv'}
2025-10-21 21:04:55,788 - INFO - __main__ 255 - Log detallado: logs/log_TEST 1 - Modelo Final  - Reoptimizando con Historicas 1_2025-10-21_19-33-41.log
2025-10-21 21:04:55,788 - INFO - __main__ 258 - >>> Ejecuci√≥n finalizada. Revisar logs para mas detalles.
